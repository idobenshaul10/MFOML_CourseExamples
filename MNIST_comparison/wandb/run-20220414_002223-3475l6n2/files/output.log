Training tree model...
Predicting WF RF
/home/ido/projects/MNIST_comparison/random_forest_2.py:96: RuntimeWarning: invalid value encountered in sqrt
  norms = np.multiply(norms, np.sqrt(volumes))
  0%|                                                                                                            | 0/50 [00:00<?, ?it/s]
TOTAL train_mae:34.61251743166031
test_mae with all wavelets:34.47420884935127
num_wavelets:50
train_mae:34.64212724355255
test_mae 50 wavelets:34.45130413430771
***********************
num_wavelets:546
train_mae:34.64934016702684
test_mae 546 wavelets:34.48757787750649
***********************
num_wavelets:1042
train_mae:34.62387337415038
test_mae 1042 wavelets:34.49088917914188
***********************
num_wavelets:1538
train_mae:0.6403139564082503
test_mae 1538 wavelets:0.7734675478954969
***********************
num_wavelets:2034
train_mae:0.6261888434010793
test_mae 2034 wavelets:0.780719655696132
***********************
num_wavelets:2530
train_mae:0.608497538306046
test_mae 2530 wavelets:0.7750993035540613
***********************


 18%|██████████████████                                                                                  | 9/50 [00:03<00:25,  1.61it/s]
train_mae:0.5760508933439333
test_mae 3026 wavelets:0.7529003614405468
***********************
num_wavelets:3522
train_mae:0.555275363485256
test_mae 3522 wavelets:0.7425481707243312
***********************
num_wavelets:4018
train_mae:0.5382159910119919
test_mae 4018 wavelets:0.7384220218099555
***********************
num_wavelets:4514
train_mae:0.5228701806784735
test_mae 4514 wavelets:0.7310016020785701
***********************


 24%|███████████████████████▊                                                                           | 12/50 [00:07<00:40,  1.07s/it]
train_mae:0.505476135577224
test_mae 5010 wavelets:0.7275014128645388
***********************
num_wavelets:5506
train_mae:0.49143544705422915
test_mae 5506 wavelets:0.7168135610970855
***********************
num_wavelets:6002
train_mae:0.48239328432252837
test_mae 6002 wavelets:0.712018341079564
***********************
num_wavelets:6498
train_mae:0.47023167122773946
test_mae 6498 wavelets:0.7100339405016058
***********************

 28%|███████████████████████████▋                                                                       | 14/50 [00:10<00:49,  1.36s/it]
train_mae:0.44058608599855936
test_mae 6994 wavelets:0.6926181535588012
***********************

 30%|█████████████████████████████▋                                                                     | 15/50 [00:12<00:52,  1.50s/it]
train_mae:0.41009481907479584
test_mae 7490 wavelets:0.6662335040317438
***********************


 34%|█████████████████████████████████▋                                                                 | 17/50 [00:16<00:59,  1.81s/it]
train_mae:0.3943192258591468
test_mae 7986 wavelets:0.65740170014476
***********************

 36%|███████████████████████████████████▋                                                               | 18/50 [00:19<01:03,  1.98s/it]
train_mae:0.37722183555424776
test_mae 8482 wavelets:0.6471147269507155
***********************
num_wavelets:8978
train_mae:0.36681303258043674
test_mae 8978 wavelets:0.6370680763460997
***********************
num_wavelets:9474
train_mae:0.35807979718534394
test_mae 9474 wavelets:0.6316132262160484
***********************


 42%|█████████████████████████████████████████▌                                                         | 21/50 [00:27<01:10,  2.44s/it]
train_mae:0.34882591217112296
test_mae 9970 wavelets:0.6252944179709178
***********************

 44%|███████████████████████████████████████████▌                                                       | 22/50 [00:30<01:13,  2.62s/it]
train_mae:0.3398693139015746
test_mae 10466 wavelets:0.6204943368542333
***********************
num_wavelets:10962
train_mae:0.3318653478694841
test_mae 10962 wavelets:0.6178133828644501
***********************


 48%|███████████████████████████████████████████████▌                                                   | 24/50 [00:36<01:16,  2.95s/it]
train_mae:0.3255943051119021
test_mae 11458 wavelets:0.616750432826159
***********************
num_wavelets:11954

 50%|█████████████████████████████████████████████████▌                                                 | 25/50 [00:40<01:18,  3.14s/it]
test_mae 11954 wavelets:0.6143819735208874
***********************
num_wavelets:12450

 52%|███████████████████████████████████████████████████▍                                               | 26/50 [00:43<01:19,  3.31s/it]
test_mae 12450 wavelets:0.6061021222461295
***********************
num_wavelets:12946
train_mae:0.2902683531202796
test_mae 12946 wavelets:0.5993007039064743
***********************

 54%|█████████████████████████████████████████████████████▍                                             | 27/50 [00:47<01:19,  3.46s/it]

 58%|█████████████████████████████████████████████████████████▍                                         | 29/50 [00:55<01:18,  3.73s/it]
test_mae 13442 wavelets:0.5898232680410279
***********************
num_wavelets:13938
train_mae:0.2632725587368459
test_mae 13938 wavelets:0.5828286152694044
***********************
num_wavelets:14434
train_mae:0.24247756834545525
test_mae 14434 wavelets:0.5676666684769768
***********************


 62%|█████████████████████████████████████████████████████████████▍                                     | 31/50 [01:04<01:15,  3.97s/it]
train_mae:0.23075943016282124
test_mae 14930 wavelets:0.5643377121003563
***********************

 64%|███████████████████████████████████████████████████████████████▎                                   | 32/50 [01:08<01:13,  4.08s/it]
train_mae:0.2173696560306424
test_mae 15426 wavelets:0.5580093215942193
***********************
num_wavelets:15922
train_mae:0.19424676914502728
test_mae 15922 wavelets:0.5409776644561975
***********************

 68%|███████████████████████████████████████████████████████████████████▎                               | 34/50 [01:17<01:08,  4.30s/it]

 70%|█████████████████████████████████████████████████████████████████████▎                             | 35/50 [01:22<01:06,  4.44s/it]
test_mae 16418 wavelets:0.5245782958184396
***********************
num_wavelets:16914
train_mae:0.15620405700535456
test_mae 16914 wavelets:0.5182963896947438
***********************
num_wavelets:17410
train_mae:0.14796332907070517
test_mae 17410 wavelets:0.51481646046006
***********************
num_wavelets:17906
train_mae:0.12536672911091387
test_mae 17906 wavelets:0.5054278947601369
***********************

 72%|███████████████████████████████████████████████████████████████████████▎                           | 36/50 [01:27<01:03,  4.56s/it]


 76%|███████████████████████████████████████████████████████████████████████████▏                       | 38/50 [01:36<00:57,  4.78s/it]
test_mae 18402 wavelets:0.4939945942813757
***********************
num_wavelets:18898
train_mae:0.1018634054027697
test_mae 18898 wavelets:0.4911768716665881
***********************

 78%|█████████████████████████████████████████████████████████████████████████████▏                     | 39/50 [01:42<00:53,  4.90s/it]
train_mae:0.08685354627406981
test_mae 19394 wavelets:0.485685307080954
***********************

 80%|███████████████████████████████████████████████████████████████████████████████▏                   | 40/50 [01:47<00:50,  5.01s/it]
train_mae:0.08123290215719359
test_mae 19890 wavelets:0.48132324002931615
***********************

 82%|█████████████████████████████████████████████████████████████████████████████████▏                 | 41/50 [01:52<00:46,  5.13s/it]
train_mae:0.07602012647962998
test_mae 20386 wavelets:0.4814865937518109
***********************
num_wavelets:20882

 86%|█████████████████████████████████████████████████████████████████████████████████████▏             | 43/50 [02:04<00:38,  5.43s/it]
test_mae 20882 wavelets:0.4748575349315246
***********************
num_wavelets:21378

 88%|███████████████████████████████████████████████████████████████████████████████████████            | 44/50 [02:10<00:33,  5.53s/it]
test_mae 21378 wavelets:0.4684661612322073
***********************
num_wavelets:21874
train_mae:0.050425232496091356
test_mae 21874 wavelets:0.46417213974033467
***********************

 92%|███████████████████████████████████████████████████████████████████████████████████████████        | 46/50 [02:22<00:23,  5.79s/it]
train_mae:0.04345109229605453
test_mae 22370 wavelets:0.46317550939005125
***********************
num_wavelets:22866

 94%|█████████████████████████████████████████████████████████████████████████████████████████████      | 47/50 [02:28<00:17,  5.88s/it]
test_mae 22866 wavelets:0.46357397379390314
***********************
num_wavelets:23362

 96%|███████████████████████████████████████████████████████████████████████████████████████████████    | 48/50 [02:34<00:11,  5.99s/it]
test_mae 23362 wavelets:0.46189586579248515
***********************
num_wavelets:23858
train_mae:0.03223238833496946
test_mae 23858 wavelets:0.45853624223873796
***********************

100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [02:47<00:00,  3.34s/it]
train_mae:0.029202151252541938
test_mae 24354 wavelets:0.458347556452523
***********************
Predicting normal RF...
train_mae:35.32787156927845
test_mae:34.45025641025641