Training tree model...
Predicting WF RF
  3%|█▉                                                              | 3/101 [00:00<00:07, 13.52it/s]
TOTAL train_mae:0.0707468630528392
test_mae with all wavelets:0.47632825071225077
num_wavelets:1
train_mae:28.192187500696892
test_mae 1 wavelets:28.025253402902457
***********************
num_wavelets:211
train_mae:0.5653913710365001
test_mae 211 wavelets:0.669666327503816
***********************
num_wavelets:421
train_mae:0.5014174627201933
test_mae 421 wavelets:0.6272137447882824
***********************
num_wavelets:631

  8%|█████                                                           | 8/101 [00:02<00:32,  2.86it/s]
test_mae 631 wavelets:0.6159842457185907
***********************
num_wavelets:841
train_mae:0.45514253946192096
test_mae 841 wavelets:0.6076165291859028
***********************
num_wavelets:1051
train_mae:0.4349270627773212
test_mae 1051 wavelets:0.6010133428823448
***********************
num_wavelets:1261
train_mae:0.4202545789701005
test_mae 1261 wavelets:0.5948664424882293
***********************
num_wavelets:1471
train_mae:0.4059121737688927
test_mae 1471 wavelets:0.5902253852493924
***********************
num_wavelets:1681
train_mae:0.3933207513082603
test_mae 1681 wavelets:0.5871241758206193
***********************
num_wavelets:1891
train_mae:0.3802274999827858
test_mae 1891 wavelets:0.5792338186196957
***********************
num_wavelets:2101
train_mae:0.36942154974982366
test_mae 2101 wavelets:0.572490726282869
***********************

 12%|███████▍                                                       | 12/101 [00:04<00:55,  1.60it/s]
train_mae:0.35718752667398607
test_mae 2311 wavelets:0.5667338693533984
***********************
num_wavelets:2521
train_mae:0.3468447603497493
test_mae 2521 wavelets:0.5598812774908218
***********************
num_wavelets:2731
train_mae:0.3377112627289753
test_mae 2731 wavelets:0.5525269671101253
***********************

 14%|████████▋                                                      | 14/101 [00:06<01:08,  1.27it/s]
train_mae:0.33031327625888035
test_mae 2941 wavelets:0.5503602609663626
***********************

 16%|█████████▉                                                     | 16/101 [00:08<01:17,  1.09it/s]
train_mae:0.3206750920154005
test_mae 3151 wavelets:0.545406504193977
***********************
num_wavelets:3361
train_mae:0.3114860201425573
test_mae 3361 wavelets:0.5456804718972793
***********************


 20%|████████████▍                                                  | 20/101 [00:13<01:37,  1.21s/it]
train_mae:0.30381418007741146
test_mae 3571 wavelets:0.5420296187064735
***********************
num_wavelets:3781
train_mae:0.2969805380251258
test_mae 3781 wavelets:0.5397704071005001
***********************
num_wavelets:3991
train_mae:0.28970551784218673
test_mae 3991 wavelets:0.5374371133002656
***********************

 21%|█████████████                                                  | 21/101 [00:15<01:42,  1.29s/it]
train_mae:0.28232920701299474
test_mae 4201 wavelets:0.5364388912234944
***********************
num_wavelets:4411
train_mae:0.27571009854610207
test_mae 4411 wavelets:0.5387030052477788
***********************

 23%|██████████████▎                                                | 23/101 [00:18<01:51,  1.42s/it]
train_mae:0.26840360050797046
test_mae 4621 wavelets:0.5380934297834479
***********************
num_wavelets:4831
train_mae:0.262154419184424
test_mae 4831 wavelets:0.5365595835732495
***********************
num_wavelets:5041
train_mae:0.2561406951899631
test_mae 5041 wavelets:0.5368982184127508
***********************


 26%|████████████████▏                                              | 26/101 [00:23<02:02,  1.64s/it]
train_mae:0.24983352581434046
test_mae 5251 wavelets:0.5319768233885532
***********************

 27%|████████████████▊                                              | 27/101 [00:25<02:06,  1.72s/it]
train_mae:0.24499301283324898
test_mae 5461 wavelets:0.5317045151499367
***********************
num_wavelets:5671
train_mae:0.23876921326383313
test_mae 5671 wavelets:0.5287701833788137
***********************


 29%|██████████████████                                             | 29/101 [00:29<02:13,  1.86s/it]
train_mae:0.23341301510881785
test_mae 5881 wavelets:0.5248865331423097
***********************
num_wavelets:6091
train_mae:0.22888841995278847
test_mae 6091 wavelets:0.5230538532243898
***********************

 30%|██████████████████▋                                            | 30/101 [00:31<02:17,  1.94s/it]
train_mae:0.22449416252493828
test_mae 6301 wavelets:0.5209411701509001
***********************

 31%|███████████████████▎                                           | 31/101 [00:33<02:20,  2.00s/it]
train_mae:0.21956897482166607
test_mae 6511 wavelets:0.521298562390793
***********************
num_wavelets:6721
train_mae:0.2142365836278865
test_mae 6721 wavelets:0.5177727174075991
***********************


 33%|████████████████████▌                                          | 33/101 [00:38<02:28,  2.18s/it]
train_mae:0.20926780399935932
test_mae 6931 wavelets:0.5135389418605301
***********************

 35%|█████████████████████▊                                         | 35/101 [00:43<02:32,  2.31s/it]
train_mae:0.20516888622270624
test_mae 7141 wavelets:0.5109322460104373
***********************
num_wavelets:7351
train_mae:0.20059515525657406
test_mae 7351 wavelets:0.5080908089637554
***********************


 37%|███████████████████████                                        | 37/101 [00:48<02:36,  2.45s/it]
train_mae:0.19569683280407543
test_mae 7561 wavelets:0.5091623962186925
***********************

 38%|███████████████████████▋                                       | 38/101 [00:51<02:37,  2.51s/it]
train_mae:0.19154659424795206
test_mae 7771 wavelets:0.5077388466946644
***********************

 39%|████████████████████████▎                                      | 39/101 [00:53<02:39,  2.57s/it]
train_mae:0.187427897335728
test_mae 7981 wavelets:0.5063700991169597
***********************
num_wavelets:8191
train_mae:0.18385492710614523
test_mae 8191 wavelets:0.505205515764636
***********************

 40%|████████████████████████▉                                      | 40/101 [00:56<02:40,  2.64s/it]
train_mae:0.17948141186088432
test_mae 8401 wavelets:0.5032215487438745
***********************

 41%|█████████████████████████▌                                     | 41/101 [00:59<02:41,  2.70s/it]
train_mae:0.17523345524148481
test_mae 8611 wavelets:0.50028513921031
***********************


 43%|██████████████████████████▊                                    | 43/101 [01:05<02:45,  2.85s/it]
train_mae:0.17106413605602747
test_mae 8821 wavelets:0.49847342662895017
***********************
num_wavelets:9031
train_mae:0.16822001579253892
test_mae 9031 wavelets:0.49904757460921373
***********************

 44%|███████████████████████████▍                                   | 44/101 [01:11<01:32,  1.62s/it]
Traceback (most recent call last):
  File "/home/ido/projects/MNIST_comparison/train_RF_wine.py", line 124, in <module>
    main(seed=i)
  File "/home/ido/projects/MNIST_comparison/train_RF_wine.py", line 97, in main
    predict_WF_RF(rf_model, X_train, Y_train, X_test, Y_test)
  File "/home/ido/projects/MNIST_comparison/train_RF_wine.py", line 67, in predict_WF_RF
    X_pred, _ = rf_model.predict(X, m=num_wavelets, paths=train_paths)
  File "/home/ido/projects/MNIST_comparison/WaveletForest.py", line 311, in predict
    pruned[:, cur_sorted_norms] = paths[:, cur_sorted_norms]
  File "/home/ido/miniconda3/envs/sparsity_probe_env/lib/python3.9/site-packages/scipy/sparse/_lil.py", line 332, in __setitem__
    IndexMixin.__setitem__(self, key, x)
  File "/home/ido/miniconda3/envs/sparsity_probe_env/lib/python3.9/site-packages/scipy/sparse/_index.py", line 137, in __setitem__
    self._set_arrayXarray_sparse(i, j, x)
  File "/home/ido/miniconda3/envs/sparsity_probe_env/lib/python3.9/site-packages/scipy/sparse/_lil.py", line 320, in _set_arrayXarray_sparse
    self._set_arrayXarray(row, col, x)
  File "/home/ido/miniconda3/envs/sparsity_probe_env/lib/python3.9/site-packages/scipy/sparse/_lil.py", line 304, in _set_arrayXarray
    _csparsetools.lil_fancy_set(self.shape[0], self.shape[1],
KeyboardInterrupt