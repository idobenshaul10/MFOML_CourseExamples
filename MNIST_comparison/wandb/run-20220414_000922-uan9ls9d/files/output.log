/home/ido/projects/MNIST_comparison/WaveletForest.py:147: RuntimeWarning: invalid value encountered in power
  norms = np.multiply(norms, np.power(volumes, 1 / self.power))
/home/ido/projects/MNIST_comparison/WaveletForest.py:147: RuntimeWarning: invalid value encountered in power
  norms = np.multiply(norms, np.power(volumes, 1 / self.power))
 22%|█████████████████████▊                                                                             | 11/50 [00:00<00:03, 11.06it/s]
Training tree model...
Predicting WF RF
TOTAL train_mae:0.16835995535483297
test_mae with all wavelets:0.6356410256410259
num_wavelets:50
train_mae:34.68595742527749
test_mae 50 wavelets:34.47992154617276
***********************
num_wavelets:134
train_mae:34.67586894276196
test_mae 134 wavelets:34.50491100853433
***********************
num_wavelets:218
train_mae:34.59015576753902
test_mae 218 wavelets:34.430318149237195
***********************
num_wavelets:302
train_mae:0.6442552165160962
test_mae 302 wavelets:0.7711814099212237
***********************
num_wavelets:386
train_mae:0.6358690894125159
test_mae 386 wavelets:0.7752354043114517
***********************
num_wavelets:470
train_mae:0.6190248992370201
test_mae 470 wavelets:0.78068103587648
***********************
num_wavelets:554
train_mae:0.6042098794255719
test_mae 554 wavelets:0.7720444599487973
***********************
num_wavelets:638
train_mae:0.5886422722464408
test_mae 638 wavelets:0.7740190275157015
***********************
num_wavelets:722
train_mae:0.580321518540836
test_mae 722 wavelets:0.7696512454013288
***********************
num_wavelets:806
train_mae:0.5673982085225614
test_mae 806 wavelets:0.7643726279260498
***********************
num_wavelets:890
train_mae:0.5682018504907775
test_mae 890 wavelets:0.7724739937104022
***********************

 36%|███████████████████████████████████▋                                                               | 18/50 [00:02<00:06,  5.00it/s]
train_mae:0.5521698370303278
test_mae 974 wavelets:0.7546081652986261
***********************
num_wavelets:1058
train_mae:0.5455173972297699
test_mae 1058 wavelets:0.7522732168447284
***********************
num_wavelets:1142
train_mae:0.5375787135112153
test_mae 1142 wavelets:0.7586507342619951
***********************
num_wavelets:1226
train_mae:0.5257252633285341
test_mae 1226 wavelets:0.7556905813964385
***********************
num_wavelets:1310
train_mae:0.5205896054554751
test_mae 1310 wavelets:0.7487119542196096
***********************
num_wavelets:1394
train_mae:0.4803232764432388
test_mae 1394 wavelets:0.7327551951019564
***********************
num_wavelets:1478
train_mae:0.4778825799245968
test_mae 1478 wavelets:0.7341636835158476
***********************

 48%|███████████████████████████████████████████████▌                                                   | 24/50 [00:04<00:09,  2.84it/s]
train_mae:0.46891180638827057
test_mae 1562 wavelets:0.7213521137690142
***********************
num_wavelets:1646
train_mae:0.46346838329024703
test_mae 1646 wavelets:0.7184210392203731
***********************
num_wavelets:1730
train_mae:0.4566647490897243
test_mae 1730 wavelets:0.716312092239337
***********************
num_wavelets:1814
train_mae:0.44699285080749135
test_mae 1814 wavelets:0.7051510314701239
***********************
num_wavelets:1898
train_mae:0.4414842947476342
test_mae 1898 wavelets:0.6986243828673315
***********************
num_wavelets:1982
train_mae:0.4377537068359533
test_mae 1982 wavelets:0.6986818019392437
***********************

 58%|█████████████████████████████████████████████████████████▍                                         | 29/50 [00:07<00:09,  2.12it/s]
train_mae:0.4291277073001413
test_mae 2066 wavelets:0.6938766086532617
***********************
num_wavelets:2150
train_mae:0.4268955535400697
test_mae 2150 wavelets:0.6932635772679508
***********************
num_wavelets:2234
train_mae:0.42188028266618566
test_mae 2234 wavelets:0.686900666954661
***********************
num_wavelets:2318
train_mae:0.41639965312761035
test_mae 2318 wavelets:0.6914064175726662
***********************
num_wavelets:2402
train_mae:0.35315401221884063
test_mae 2402 wavelets:0.6429031826978767
***********************

 64%|███████████████████████████████████████████████████████████████▎                                   | 32/50 [00:08<00:09,  1.93it/s]
train_mae:0.3379638919280518
test_mae 2486 wavelets:0.6419190888113822
***********************
num_wavelets:2570
train_mae:0.3130704239908708
test_mae 2570 wavelets:0.6271782581881745
***********************
num_wavelets:2654
train_mae:0.3077670488272412
test_mae 2654 wavelets:0.6282816592295191
***********************
num_wavelets:2738

 72%|███████████████████████████████████████████████████████████████████████▎                           | 36/50 [00:11<00:08,  1.72it/s]
test_mae 2738 wavelets:0.6263851124703632
***********************
num_wavelets:2822
train_mae:0.2966981644096087
test_mae 2822 wavelets:0.6201157862929955
***********************
num_wavelets:2906
train_mae:0.2904516760841754
test_mae 2906 wavelets:0.6150698936044584
***********************
num_wavelets:2990
train_mae:0.2746959522554031
test_mae 2990 wavelets:0.6060851922770267
***********************

 78%|█████████████████████████████████████████████████████████████████████████████▏                     | 39/50 [00:12<00:06,  1.57it/s]
train_mae:0.26610669004319765
test_mae 3074 wavelets:0.6106496437003816
***********************
num_wavelets:3158
train_mae:0.2497212563984265
test_mae 3158 wavelets:0.626647191561675
***********************
num_wavelets:3242
train_mae:0.24562895806855187
test_mae 3242 wavelets:0.626232595305528
***********************

 84%|███████████████████████████████████████████████████████████████████████████████████▏               | 42/50 [00:15<00:05,  1.45it/s]
train_mae:0.23581893721341946
test_mae 3326 wavelets:0.6249278361415112
***********************
num_wavelets:3410
train_mae:0.22832422356179113
test_mae 3410 wavelets:0.627450009290865
***********************
num_wavelets:3494
train_mae:0.2222433735450175
test_mae 3494 wavelets:0.6324842646742058
***********************
num_wavelets:3578
train_mae:0.21135425120307344
test_mae 3578 wavelets:0.6346644133407741
***********************
num_wavelets:3662
train_mae:0.20536281260095995
test_mae 3662 wavelets:0.6321494285586228
***********************

 90%|█████████████████████████████████████████████████████████████████████████████████████████          | 45/50 [00:17<00:03,  1.35it/s]
train_mae:0.2016670009488348
test_mae 3746 wavelets:0.6420038473555427
***********************
num_wavelets:3830
train_mae:0.19239294176789606
test_mae 3830 wavelets:0.6410358571820062
***********************
num_wavelets:3914
train_mae:0.1833309451575704
test_mae 3914 wavelets:0.641182197435149
***********************
num_wavelets:3998
train_mae:0.1758543261011849
test_mae 3998 wavelets:0.6336196499577815
***********************


100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:21<00:00,  2.30it/s]
train_mae:0.17415574631458422
test_mae 4082 wavelets:0.6356436672288596
***********************
num_wavelets:4166
train_mae:0.17125547165216845
test_mae 4166 wavelets:0.634835293381366
***********************
Predicting normal RF...
train_mae:1.4253893516841725
test_mae:1.3269230769230769