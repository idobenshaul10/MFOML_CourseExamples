/home/ido/projects/MNIST_comparison/WaveletForest.py:147: RuntimeWarning: invalid value encountered in power
  norms = np.multiply(norms, np.power(volumes, 1 / self.power))
/home/ido/projects/MNIST_comparison/WaveletForest.py:147: RuntimeWarning: invalid value encountered in power
  norms = np.multiply(norms, np.power(volumes, 1 / self.power))
 22%|█████████████████████▎                                                                             | 11/51 [00:00<00:03, 11.95it/s]
Training tree model...
Predicting WF RF
TOTAL train_mae:0.1697774937803186
test_mae with all wavelets:0.6346102908600065
num_wavelets:0
train_mae:34.645237232886636
test_mae 0 wavelets:34.45025641025641
***********************
num_wavelets:80
train_mae:34.67882384143224
test_mae 80 wavelets:34.47795166170259
***********************
num_wavelets:160
train_mae:34.65264084925289
test_mae 160 wavelets:34.510605018802515
***********************
num_wavelets:240
train_mae:34.65239764899128
test_mae 240 wavelets:34.519342818481334
***********************
num_wavelets:320
train_mae:0.6503563016616807
test_mae 320 wavelets:0.7713338673048369
***********************
num_wavelets:400
train_mae:0.6356757564679458
test_mae 400 wavelets:0.7863401729031816
***********************
num_wavelets:480
train_mae:0.6100682171590154
test_mae 480 wavelets:0.7746728360396604
***********************
num_wavelets:560
train_mae:0.5999466653740452
test_mae 560 wavelets:0.781541665507759
***********************
num_wavelets:640
train_mae:0.5944641106219808
test_mae 640 wavelets:0.7906601340018551
***********************
num_wavelets:720
train_mae:0.5794623454647144
test_mae 720 wavelets:0.7814107431334223
***********************
num_wavelets:800
train_mae:0.5723119293013295
test_mae 800 wavelets:0.7785444724189314
***********************

 39%|██████████████████████████████████████▊                                                            | 20/51 [00:02<00:07,  4.22it/s]
train_mae:0.5692473090064785
test_mae 880 wavelets:0.7813628498619296
***********************
num_wavelets:960
train_mae:0.5574258492947674
test_mae 960 wavelets:0.7664852036199684
***********************
num_wavelets:1040
train_mae:0.5550964328194636
test_mae 1040 wavelets:0.7699026806911783
***********************
num_wavelets:1120
train_mae:0.540715267655055
test_mae 1120 wavelets:0.7652949751897983
***********************
num_wavelets:1200
train_mae:0.5258826337156408
test_mae 1200 wavelets:0.7601844505000512
***********************
num_wavelets:1280
train_mae:0.5227356230904601
test_mae 1280 wavelets:0.7591347759226946
***********************
num_wavelets:1360
train_mae:0.48356210444206
test_mae 1360 wavelets:0.743597053468086
***********************
num_wavelets:1440
train_mae:0.4851901318675294
test_mae 1440 wavelets:0.7456813873107401
***********************
num_wavelets:1520
train_mae:0.474816217080021
test_mae 1520 wavelets:0.7315429191252276
***********************

 51%|██████████████████████████████████████████████████▍                                                | 26/51 [00:05<00:09,  2.65it/s]
train_mae:0.46635767141085466
test_mae 1600 wavelets:0.7297010115086184
***********************
num_wavelets:1680
train_mae:0.46338892287537214
test_mae 1680 wavelets:0.7340890536272345
***********************
num_wavelets:1760
train_mae:0.4518094150924724
test_mae 1760 wavelets:0.7189280487813621
***********************
num_wavelets:1840
train_mae:0.4487415077683285
test_mae 1840 wavelets:0.7139453667537343
***********************
num_wavelets:1920
train_mae:0.4454517130189056
test_mae 1920 wavelets:0.7107016611848045
***********************
num_wavelets:2000
train_mae:0.43584931507014646
test_mae 2000 wavelets:0.7073242747631274
***********************
num_wavelets:2080
train_mae:0.43450827017098004
test_mae 2080 wavelets:0.7067809622568618
***********************
num_wavelets:2160
train_mae:0.42635365527546776
test_mae 2160 wavelets:0.702267827612985
***********************
num_wavelets:2240
train_mae:0.41714823834541886
test_mae 2240 wavelets:0.7009274555096631
***********************
num_wavelets:2320


 65%|████████████████████████████████████████████████████████████████                                   | 33/51 [00:08<00:08,  2.01it/s]
test_mae 2320 wavelets:0.7070724537651366
***********************
num_wavelets:2400
train_mae:0.40842431238607185
test_mae 2400 wavelets:0.7040112247181921
***********************
num_wavelets:2480
train_mae:0.3841986225620011
test_mae 2480 wavelets:0.6829337076906632
***********************
num_wavelets:2560
train_mae:0.3727643043788074
test_mae 2560 wavelets:0.6721278519979613
***********************
num_wavelets:2640

 75%|█████████████████████████████████████████████████████████████████████████▊                         | 38/51 [00:11<00:07,  1.69it/s]
test_mae 2640 wavelets:0.6289160254877839
***********************
num_wavelets:2720
train_mae:0.28145526361066814
test_mae 2720 wavelets:0.6187730285670187
***********************
num_wavelets:2800
train_mae:0.2559549837002318
test_mae 2800 wavelets:0.6129571508580858
***********************
num_wavelets:2880
train_mae:0.2500278791462133
test_mae 2880 wavelets:0.6122066784511023
***********************
num_wavelets:2960
train_mae:0.24449093476667724
test_mae 2960 wavelets:0.6185191200068072
***********************

 80%|███████████████████████████████████████████████████████████████████████████████▌                   | 41/51 [00:13<00:06,  1.61it/s]
train_mae:0.239448637357013
test_mae 3040 wavelets:0.6218773380221169
***********************
num_wavelets:3120
train_mae:0.23407329367600735
test_mae 3120 wavelets:0.6225720521267804
***********************
num_wavelets:3200
train_mae:0.227379255179768
test_mae 3200 wavelets:0.6294792090013539
***********************

 86%|█████████████████████████████████████████████████████████████████████████████████████▍             | 44/51 [00:15<00:04,  1.50it/s]
train_mae:0.22148271515874407
test_mae 3280 wavelets:0.631720375722982
***********************
num_wavelets:3360
train_mae:0.21652019568016362
test_mae 3360 wavelets:0.6309459172020304
***********************
num_wavelets:3440
train_mae:0.21123527424455707
test_mae 3440 wavelets:0.6252548168902597
***********************

 92%|███████████████████████████████████████████████████████████████████████████████████████████▏       | 47/51 [00:17<00:02,  1.35it/s]
train_mae:0.20689339659077188
test_mae 3520 wavelets:0.6228569523337557
***********************
num_wavelets:3600
train_mae:0.19804351023718023
test_mae 3600 wavelets:0.6197490651891333
***********************
num_wavelets:3680
train_mae:0.1939883681283451
test_mae 3680 wavelets:0.62166783627896
***********************

 98%|█████████████████████████████████████████████████████████████████████████████████████████████████  | 50/51 [00:20<00:00,  1.24it/s]
train_mae:0.18806950695980443
test_mae 3760 wavelets:0.6223067171003717
***********************
num_wavelets:3840
train_mae:0.18057471980780962
test_mae 3840 wavelets:0.6319918770570548
***********************
num_wavelets:3920
train_mae:0.17336276762269426
test_mae 3920 wavelets:0.63202105484111
***********************
num_wavelets:4000
train_mae:0.17064729944177234
test_mae 4000 wavelets:0.6336820305245993
***********************
Predicting normal RF...
train_mae:1.3849151122781596

100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:21<00:00,  2.41it/s]