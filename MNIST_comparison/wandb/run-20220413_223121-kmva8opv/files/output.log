/home/ido/projects/MNIST_comparison/WaveletForest.py:147: RuntimeWarning: invalid value encountered in power
  norms = np.multiply(norms, np.power(volumes, 1 / self.power))
/home/ido/projects/MNIST_comparison/WaveletForest.py:147: RuntimeWarning: invalid value encountered in power
  norms = np.multiply(norms, np.power(volumes, 1 / self.power))
/home/ido/projects/MNIST_comparison/WaveletForest.py:147: RuntimeWarning: invalid value encountered in power
  norms = np.multiply(norms, np.power(volumes, 1 / self.power))
  8%|███████▊                                                                                            | 4/51 [00:00<00:01, 31.79it/s]
Training tree model...
Predicting WF RF
TOTAL train_mae:0.1275636244854973
test_mae with all wavelets:0.5636869971094742
num_wavelets:0
train_mae:34.645237232886636
test_mae 0 wavelets:34.45025641025641
***********************
num_wavelets:121
train_mae:34.68950042792651
test_mae 121 wavelets:34.47589968942432
***********************
num_wavelets:242
train_mae:34.708684739997835
test_mae 242 wavelets:34.56368342628395
***********************
num_wavelets:363
train_mae:34.7469620503645
test_mae 363 wavelets:34.60446911953643
***********************
num_wavelets:484
train_mae:0.6512135563453583
test_mae 484 wavelets:0.7722714882697239
***********************
num_wavelets:605
train_mae:0.6342570297592893
test_mae 605 wavelets:0.7838771249824091
***********************
num_wavelets:726
train_mae:0.6101645305911135
test_mae 726 wavelets:0.7638546061350459
***********************
num_wavelets:847
train_mae:0.5850172405753229
test_mae 847 wavelets:0.7515241483649628
***********************
num_wavelets:968
train_mae:0.5828291912100709
test_mae 968 wavelets:0.7598574933336668
***********************
num_wavelets:1089
train_mae:0.565543975321114
test_mae 1089 wavelets:0.7553980377333481
***********************
num_wavelets:1210
train_mae:0.5603192682502013
test_mae 1210 wavelets:0.7568991750751906
***********************
num_wavelets:1331
train_mae:0.5371765680655924
test_mae 1331 wavelets:0.7378347966848858
***********************
num_wavelets:1452
train_mae:0.532098481801029
test_mae 1452 wavelets:0.7390784515681706
***********************

 25%|█████████████████████████▏                                                                         | 13/51 [00:01<00:06,  5.60it/s]
train_mae:0.5137965648238226
test_mae 1573 wavelets:0.7313485715491078
***********************
num_wavelets:1694
train_mae:0.5023756139280671
test_mae 1694 wavelets:0.7260174764569245
***********************
num_wavelets:1815
train_mae:0.492907417288718
test_mae 1815 wavelets:0.7209941867931766
***********************
num_wavelets:1936
train_mae:0.4567210402861537
test_mae 1936 wavelets:0.6981229828910709
***********************
num_wavelets:2057
train_mae:0.44649801209033035
test_mae 2057 wavelets:0.6903265615780928
***********************
num_wavelets:2178

 35%|██████████████████████████████████▉                                                                | 18/51 [00:03<00:11,  2.91it/s]
test_mae 2178 wavelets:0.6806056864639086
***********************
num_wavelets:2299
train_mae:0.42908319317240323
test_mae 2299 wavelets:0.6771075579575991
***********************
num_wavelets:2420
train_mae:0.4216757443373416
test_mae 2420 wavelets:0.6704802504312009
***********************
num_wavelets:2541
train_mae:0.4153917928722175
test_mae 2541 wavelets:0.6661589616894394
***********************


 51%|██████████████████████████████████████████████████▍                                                | 26/51 [00:08<00:15,  1.58it/s]
train_mae:0.4086964233465319
test_mae 2662 wavelets:0.6600313027187449
***********************
num_wavelets:2783
train_mae:0.403270899942841
test_mae 2783 wavelets:0.6555942911673991
***********************
num_wavelets:2904
train_mae:0.3924704665970667
test_mae 2904 wavelets:0.6493423044030745
***********************
num_wavelets:3025
train_mae:0.38691088548805863
test_mae 3025 wavelets:0.650676828411592
***********************
num_wavelets:3146
train_mae:0.38348116083364786
test_mae 3146 wavelets:0.6491466581147196
***********************
num_wavelets:3267
train_mae:0.374872683215524
test_mae 3267 wavelets:0.6495463507371217
***********************
num_wavelets:3388
train_mae:0.3644016650111405
test_mae 3388 wavelets:0.6456645421313628
***********************


 61%|████████████████████████████████████████████████████████████▏                                      | 31/51 [00:12<00:15,  1.28it/s]
train_mae:0.36010781383019136
test_mae 3509 wavelets:0.6503616371739739
***********************
num_wavelets:3630
train_mae:0.3538494802636345
test_mae 3630 wavelets:0.6532096887640731
***********************
num_wavelets:3751
train_mae:0.3452966511962171
test_mae 3751 wavelets:0.6555146871165218
***********************

 67%|██████████████████████████████████████████████████████████████████                                 | 34/51 [00:15<00:14,  1.17it/s]
train_mae:0.32529909075661195
test_mae 3872 wavelets:0.6464130085679098
***********************
num_wavelets:3993
train_mae:0.3223140956248893
test_mae 3993 wavelets:0.642381023713315
***********************
num_wavelets:4114
train_mae:0.30591749575463756
test_mae 4114 wavelets:0.6285878370915248
***********************

 73%|███████████████████████████████████████████████████████████████████████▊                           | 37/51 [00:17<00:12,  1.09it/s]
train_mae:0.26196422072209874
test_mae 4235 wavelets:0.6014392394453514
***********************
num_wavelets:4356
train_mae:0.2532006361137925
test_mae 4356 wavelets:0.5998253344777442
***********************
num_wavelets:4477
train_mae:0.24628665196964514
test_mae 4477 wavelets:0.5939659859613016
***********************
num_wavelets:4598
train_mae:0.2127308217087513
test_mae 4598 wavelets:0.5763740354506742
***********************


 80%|███████████████████████████████████████████████████████████████████████████████▌                   | 41/51 [00:22<00:10,  1.02s/it]
train_mae:0.20668570447314027
test_mae 4719 wavelets:0.5742007151090545
***********************
num_wavelets:4840
train_mae:0.2001019072870839
test_mae 4840 wavelets:0.5757377403620073
***********************
num_wavelets:4961
train_mae:0.19256387220508797
test_mae 4961 wavelets:0.571500543692185
***********************

 84%|███████████████████████████████████████████████████████████████████████████████████▍               | 43/51 [00:24<00:08,  1.08s/it]
train_mae:0.18749360805960608
test_mae 5082 wavelets:0.5694778508573511
***********************
num_wavelets:5203
train_mae:0.18369951510723764
test_mae 5203 wavelets:0.5684824644325681
***********************


 92%|███████████████████████████████████████████████████████████████████████████████████████████▏       | 47/51 [00:29<00:04,  1.21s/it]
train_mae:0.17783475099260498
test_mae 5324 wavelets:0.5617713687215895
***********************
num_wavelets:5445
train_mae:0.17427730317101153
test_mae 5445 wavelets:0.5644268775479122
***********************
num_wavelets:5566
train_mae:0.1705291998980573
test_mae 5566 wavelets:0.5640177782415858
***********************
num_wavelets:5687
train_mae:0.1497383571856217
test_mae 5687 wavelets:0.5592450210659181
***********************
num_wavelets:5808
train_mae:0.147394833902634
test_mae 5808 wavelets:0.5602557819329332
***********************

 96%|███████████████████████████████████████████████████████████████████████████████████████████████    | 49/51 [00:31<00:02,  1.27s/it]
train_mae:0.1355397416829276
test_mae 5929 wavelets:0.5596367607068501
***********************
num_wavelets:6050
train_mae:0.12870425841460403
test_mae 6050 wavelets:0.5614207000716751
***********************
Predicting normal RF...
train_mae:1.3982676365246087

100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:34<00:00,  1.47it/s]